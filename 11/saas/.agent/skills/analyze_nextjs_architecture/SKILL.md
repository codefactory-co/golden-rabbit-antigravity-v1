---
name: analyze_nextjs_architecture
description: Next.js ν”„λ΅μ νΈμ μ•„ν‚¤ν…μ² κ±΄μ „μ„±, μ»΄ν¬λ„νΈ ν¨ν„΄(μ„λ²„/ν΄λΌμ΄μ–ΈνΈ), κ·Έλ¦¬κ³  λ³΄μ• μ·¨μ•½μ μ„ λ¶„μ„ν•©λ‹λ‹¤.
---

# Next.js μ•„ν‚¤ν…μ² λ° λ³΄μ• λ¶„μ„ (Analyze Next.js Architecture)

μ΄ μ¤ν‚¬μ€ Next.js μ• ν”λ¦¬μΌ€μ΄μ…μ΄ **Clean Architecture** μ›μΉ™μ„ μ λ”°λ¥΄κ³  μλ”μ§€, **Server/Client Component**κ°€ μ μ ν μ‚¬μ©λκ³  μλ”μ§€, κ·Έλ¦¬κ³  **λ³΄μ•μƒ μ„ν—**ν• μ”μ†κ°€ μ—†λ”μ§€ μ²΄κ³„μ μΌλ΅ μ κ²€ν•κΈ° μ„ν•΄ μ‚¬μ©ν•©λ‹λ‹¤.

## μ‚¬μ©λ²•

μƒλ΅μ΄ κΈ°λ¥μ„ κµ¬ν„ν• ν›„λ‚ λ κ±°μ‹ μ½”λ“λ¥Ό λ¦¬ν©ν† λ§ν•κΈ° μ „μ— μ΄ μ¤ν‚¬μ„ μ‹¤ν–‰ν•μ—¬ μ½”λ“λ² μ΄μ¤μ κ±΄κ°• μƒνƒλ¥Ό μ§„λ‹¨ν•μ„Έμ”. λ‹¤μ λ‹¨κ³„λ“¤μ„ μμ°¨μ μΌλ΅ μν–‰ν•λ©° λ°κ²¬λ λ¬Έμ μ μ„ λ¦¬ν¬νΈν•©λ‹λ‹¤.

## μ§€μΉ¨

### 1. λ λ”λ§ μ „λµ λ° μ»΄ν¬λ„νΈ ν¨ν„΄ λ¶„μ„

κ°€μ¥ λ¨Όμ € λ¶ν•„μ”ν• ν΄λΌμ΄μ–ΈνΈ μ»΄ν¬λ„νΈ μ‚¬μ©μ„ μ‹λ³„ν•©λ‹λ‹¤.

1.  **"use client" κ²€μƒ‰**: `grep_search`λ¥Ό μ‚¬μ©ν•μ—¬ ν΄λΌμ΄μ–ΈνΈ μ»΄ν¬λ„νΈ μ‚¬μ© ν„ν™©μ„ νμ•…ν•©λ‹λ‹¤.
    ```bash
    grep -r "use client" src/
    ```
2.  **Leaf Node μ›μΉ™ κ²€μ¦**:
    *   κ²€μƒ‰λ νμΌ μ¤‘ μƒμ„ λ μ΄μ•„μ›ƒμ΄λ‚ νμ΄μ§€ μ „μ²΄μ— `"use client"`κ°€ μ„ μ–Έλ κ²½μ°κ°€ μλ”μ§€ ν™•μΈν•©λ‹λ‹¤.
    *   `view_file`λ΅ ν•΄λ‹Ή μ½”λ“λ¥Ό μ—΄μ–΄λ³΄κ³ , μ‹¤μ  `useState`, `useEffect`λ‚ μ΄λ²¤νΈ ν•Έλ“¤λ¬κ°€ μ—†λ” κ²½μ° μ„λ²„ μ»΄ν¬λ„νΈλ΅ μ „ν™μ„ μ μ•ν•©λ‹λ‹¤.

### 2. Clean Architecture μμ΅΄μ„± κ·μΉ™ κ²€μ¦

λ‚΄λ¶€ κ³„μΈµμ΄ μ™Έλ¶€ κ³„μΈµμ„ μμ΅΄ν•λ” μ„λ° μ‚¬λ΅€λ¥Ό μ°Ύμµλ‹λ‹¤.

1.  **Domain κ³„μΈµ μ¤μ—Ό ν™•μΈ**: `src/core/domain` λ””λ ‰ν† λ¦¬ λ‚΄μ νμΌλ“¤μ΄ `src/infrastructure`λ‚ `src/app`, `src/components`λ¥Ό import ν•κ³  μλ”μ§€ ν™•μΈν•©λ‹λ‹¤.
    ```bash
    grep -r "from '@/infrastructure" src/core/domain
    grep -r "from '@/app" src/core/domain
    grep -r "from '@/components" src/core/domain
    ```
    *   **κ²°κ³Ό**: μ„ λ…λ Ήμ—μ„ κ²°κ³Όκ°€ λ‚μ¨λ‹¤λ©΄ **μ‹¬κ°ν• μ•„ν‚¤ν…μ² μ„λ°**μ…λ‹λ‹¤.

2.  **Application κ³„μΈµ κµ¬ν„μ²΄ μμ΅΄ ν™•μΈ**: `src/core/application` λ‚΄μ—μ„ κµ¬μ²΄μ μΈ κµ¬ν„μ²΄(Repository Class λ“±)λ¥Ό μ§μ ‘ import ν•λ”μ§€ ν™•μΈν•©λ‹λ‹¤. μ¤μ§ `interface`λ§ μμ΅΄ν•΄μ•Ό ν•©λ‹λ‹¤.

### 3. λ³΄μ• μ·¨μ•½μ  κ°μ‚¬ (Security Audit)

Next.js λ° μ›Ή μ• ν”λ¦¬μΌ€μ΄μ…μ μΌλ°μ μΈ λ³΄μ• μ„ν—μ„ μ κ²€ν•©λ‹λ‹¤.

1.  **λ―Όκ° μ •λ³΄ λ…Έμ¶ (Sensitive Data Props)**:
    *   ν΄λΌμ΄μ–ΈνΈ μ»΄ν¬λ„νΈλ΅ μ „λ‹¬λλ” props μ¤‘ λ―Όκ°ν• μ΄λ¦„μ΄ μλ”μ§€ ν™•μΈν•©λ‹λ‹¤.
    *   ν¨ν„΄: `token`, `password`, `secret`, `key` λ“±.
    *   *μ£Όμ*: μ„λ²„ μ»΄ν¬λ„νΈμ—μ„ ν΄λΌμ΄μ–ΈνΈ μ»΄ν¬λ„νΈλ΅ μ΄ λ°μ΄ν„°λ¥Ό λ„κΈ°λ” μκ°„ λΈλΌμ°μ € λ²λ“¤μ— ν¬ν•¨λμ–΄ λ…Έμ¶λ©λ‹λ‹¤.

2.  **XSS μ„ν— (dangerouslySetInnerHTML)**:
    *   `dangerouslySetInnerHTML` μ‚¬μ©μ²λ¥Ό κ²€μƒ‰ν•©λ‹λ‹¤.
    *   μ‚¬μ©λ κ²½μ°, ν•΄λ‹Ή λ°μ΄ν„°κ°€ `dompurify` λ“±μΌλ΅ μ‚΄κ· (sanitize) μ²λ¦¬λμ—λ”μ§€ `view_file`λ΅ ν™•μΈν•©λ‹λ‹¤.

3.  **Server Actions λ³΄μ•**:
    *   `"use server"`κ°€ μ„ μ–Έλ νμΌ(`src/app/actions.ts` λ“±)μ„ κ²€μ‚¬ν•©λ‹λ‹¤.
    *   **μ…λ ¥ κ²€μ¦**: Zod λ“±μ„ μ‚¬μ©ν•μ—¬ μ…λ ¥κ°’(`FormData` λ“±)μ„ κ²€μ¦ν•κ³  μλ”μ§€ ν™•μΈν•©λ‹λ‹¤.
    *   **κ¶ν• κ²€μ‚¬**: μ•΅μ… ν•¨μ μ‹μ‘ λ¶€λ¶„μ— μΈμ¦/μΈκ°€ μ²΄ν¬(μ: `getUser()`, `assertAuthenticated()`)κ°€ μλ”μ§€ ν™•μΈν•©λ‹λ‹¤. μ΄κ²ƒμ΄ μ—†λ‹¤λ©΄ λ„κµ¬λ‚ APIλ¥Ό νΈμ¶ν•΄ λ°μ΄ν„°λ¥Ό μ΅°μ‘ν•  μ μμµλ‹λ‹¤.

### 4. μ„±λ¥ λ° μµμ ν™” μ κ²€

1.  **λ¬΄κ±°μ΄ ν¨ν‚¤μ§€ import**: ν΄λΌμ΄μ–ΈνΈ μ»΄ν¬λ„νΈμ—μ„ κ±°λ€ν• λΌμ΄λΈλ¬λ¦¬(μ: μ „μ²΄ `lodash`, λ¬΄κ±°μ΄ μ°¨νΈ λΌμ΄λΈλ¬λ¦¬ λ“±)λ¥Ό import ν•λ”μ§€ ν™•μΈν•©λ‹λ‹¤. κ°€λ¥ν•λ©΄ dynamic importλ¥Ό μ μ•ν•©λ‹λ‹¤.

## κ²°κ³Ό λ³΄κ³  ν•μ‹

λ¶„μ„μ„ λ§μΉλ©΄ λ‹¤μκ³Ό κ°™μ€ μ”μ•½ λ¦¬ν¬νΈλ¥Ό μ‘μ„±ν•μ„Έμ”:

- **β… μ–‘νΈ**: λ°κ²¬λ λ¬Έμ  μ—†μ.
- **β οΈ κ²½κ³ **: μ„±λ¥ μ΄μλ‚ κ²½λ―Έν• ν¨ν„΄ μ„λ° (μ: λ¶ν•„μ”ν• use client).
- **π¨ μ„ν—**: λ³΄μ• μ·¨μ•½μ (XSS, λ―Όκ° μ •λ³΄ λ…Έμ¶) λλ” μ‹¬κ°ν• μ•„ν‚¤ν…μ² μ›μΉ™ μ„λ°.

κ° λ¬Έμ μ— λ€ν•΄ μμ • μ μ•μ„ ν•¨κ» μ κ³µν•μ„Έμ”.
